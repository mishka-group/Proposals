# داشبورد گرافیکی نصب و مدیریت افزونه ها

---

## هدف

نصب و مدیریت راحت افزونه های ساخته شده بر روی سیستم مدیریت محتوای میشکا. این پنل باید این امکان را بدهد که مدیریت وب سایت بدون هیچ دانش برنامه نویسی مخصوصا در زبان الیکسیر یک پروژه ساخته شده چه پلاگین چه کامپوننت را در این سیستم نصب و استفاده کند. این سیستم باید بتواند بدون متوقف کردن سایت افزونه های جدید یا از قبل نصب شده را مدیریت کند.

##  مشکل

همانطور که می‌دانیم `cms` میشکا با زبان الیکسیر نوشته شده است و این زبان نیز کامپیالری می باشد. پس معرفی یک ماژول در زمانی که برنامه در حال اجرا می باشد چالش های زیادی را به همراه دارد. این چالش می تواند شامل جلوگیری کردن از مشکلات امنیتی و همینطور متوقف کردن برنامه باشد. مشکلات و چالش های ذکر شده فقط در اضافه کردن یک فایل یا یک ماژول می تواند ایجاد شود. حال اگر برای یک پروژه کامل بخواهیم به آن اشاره کنیم حل آن در موقعیت کنونی میشکا بسیار هزینه بر می باشد و داکیومنت آن نیز بسیار محدود است.

> لازم به ذکر است وابستگی های  یک پروژه کامل نیز خود به افزایش مشکلات کمک می کند

---

## راه حل

### داکر یا کوبرنتیز
اولین راه حل ایجاد یک نسخه جدید از سورس با افزونه های جدید یا ویرایش تازه از کل سورس می باشد که به وسیله پلتفرم های متن باز مذکور در تایمینگ بسیار کم جایگزین نسخه در حال اجرا می باشد. حتی فرض بر اینکه تمام `state‍` به صورت کامل نجات پیدا کند باز ممکن است وابستگی به این اکوسیستم در تیم های مختلف وجود نداشته باشد و اگر تیمی از این موارد استفاده نکند پروژه بخش بزرگی از امکاناتی که درست کرده است را از دست خواهد داد. این روال می تواند خیلی کم هزینه باشد که از ویژگی های آن می باشد.

### کامپیال کردن مجدد سورس و معرفی آن ها در run time
در این مرحله یک بار باید سورس جدید کامپیال شود و بررسی شود چه وابستگی های وجود ندارد و الان اضافه شده است. آن ها را جدا کرده و به پوشه `_build` پروژه اضافه کرده و آن را معرفی نماییم. این راه بسیار کم هزینه بوده و خطا ها به صورت کامل مشخص می شود ولی یکسری چالش مثل اجرا و کامپیال وجود دارد مثل وقتی سورس کامپیال شد چطور متوجه شویم که آن کامل کامپیال شده و مشکلی ندارد. وابستگی ها نیز باید بررسی شود که تداخل وجود نداشته باشد برای مثال از یک وابستگی دو ورژن معرفی شود یک ورژنی که در سورس اصلی هست و دیگری  در افزونه خارجی که دولپر در حال اضافه کردن آن می باشد

### ایجاد یک node جدید از سورس تازه سازی شده
ایده اصلی این موضوع به این صورت است که یک الیکسیر اسکریپت شل نوشته شود در مسیر معرفی شده به این اسکریپت یک کپی از نسخه `cms` گرفته شود و بعد از ویرایش دوباره در پرت جدید اجرا شود. حال بر اساس استراتژی که در آینده تدوین دیده خواهد شد ممکن است این پروسه نیاز به پرت جدید نداشته باشد. این ایده نیز چالش های زیادی دارد که بخاطر کامل نبودن تحقیقات میشکا و تجربه اول نسبت به این موضوع  می تواند بسیار هزینه بر باشد. لازم به ذکر است در صورت اجرایی شدن این ایده دیگر نیازی به استفاده از یک پلتفرم خاص نیست. 
> چالش های این بخش می تواند شامل موارد مثل اندک بودن دانش تیم میشکا نسبت به این موضوع - راه های ارتباطی بین `node` ها - کپی متعدد بر اساس نصب هر چند افزونه و بالا بردن حجم (که این مشکل فعلا در اولویت این نسخه نمی باشد) ولی در صورت اجرایی شدن این امکان در سیستم می توان این چشم انداز را داشت که تیم با این تجربه به سمت **Distribute** سازی این **cms** قدم بردارد.

---
## ما در حال تحقیقات می باشیم و این محتوا به زودی به روز رسانی می شود در صورتی که ایده در این زمینه دارید لطفا با ارسال PR این مطلب را به روز رسانی کنید

---
## منابع:


1. https://github.com/mishka-group/mishka_installer/issues/5
2. https://akoutmos.com/post/elixir-shell-scripts
3. https://elixirforum.com/t/how-to-add-and-install-deps-without-stopping-phoenix-server-hex-package/44888
4. https://github.com/mishka-group/Proposals/blob/master/MishkaInstaller/fa/update-application-after-restarting.md
5. https://github.com/mishka-group/Proposals/blob/master/MishkaInstaller/fa/implement-plugins-manager.md
6. https://youtu.be/FPDxyX4RzZc
7. https://youtu.be/7LX67RjkiGc
8. https://youtu.be/lcqbEsnjMGQ
9. https://elixirforum.com/t/starting-a-new-node-from-inside-elixir/47084/5
10. https://elixir-lang.org/getting-started/mix-otp/distributed-tasks.html
11. https://elixir-lang.org/getting-started/processes.html
12. https://dockyard.com/blog/2016/01/28/running-elixir-and-phoenix-projects-on-a-cluster-of-nodes
13. https://www.erlang.org/doc/man/code.html#add_patha-1
14. https://hexdocs.pm/elixir/1.13/Code.html
15. https://github.com/elixir-lang/elixir/search?q=%3Aadd_patha
16. https://hexdocs.pm/phoenix/releases.html
